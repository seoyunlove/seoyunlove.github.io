<!DOCTYPE html>
<html lang="ko">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no">
  <title>수유량 체크</title>
  <meta property="og:type" content="website">
  <meta property="og:title" content="수유량 체크">
  <link href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm"
    crossorigin="anonymous">
  <style type="text/css">
    body {
      padding: 0;
      margin: 10px;
    }
  </style>
</head>

<body>
  <h5 id="title"></h5>
  <button type="button" class="btn btn-secondary" style="width:100%;" onclick="add(70);">70 (2 스푼)</button>
  <button type="button" class="btn btn-primary" style="width:100%;margin-top:10px;" onclick="add(100);">100 (3 스푼)</button>
  <button type="button" class="btn btn-success" style="width:100%;margin-top:10px;" onclick="add(135);">135 (4 스푼)</button>
  <button type="button" class="btn btn-danger" style="width:100%;margin-top:10px;" onclick="add(170);">170 (5 스푼)</button>
  <button type="button" class="btn btn-warning" style="width:100%;margin-top:10px;" onclick="add(200);">200 (6 스푼)</button>
  <button type="button" class="btn btn-info" style="width:100%;margin-top:10px;" onclick="add(235);">235 (7 스푼)</button>
  <h5 id="h" style="margin-top:10px;">기록</h5>
  <div id="hist">
  </div>
</body>
<script>
  function setCookie(cname, cvalue) {
    var d = new Date();
    d.setTime(d.getTime() + (999 * 24 * 60 * 60 * 1000));
    var expires = "expires="+d.toUTCString();
    document.cookie = cname + "=" + cvalue + ";" + expires + ";path=/";
}

function getCookie(cname) {
    var name = cname + "=";
    var ca = document.cookie.split(';');
    for(var i = 0; i < ca.length; i++) {
        var c = ca[i];
        while (c.charAt(0) == ' ') {
            c = c.substring(1);
        }
        if (c.indexOf(name) == 0) {
            return c.substring(name.length, c.length);
        }
    }
    return "";
}
  // setCookie('shistory', null)
  var hoptions = { hour: "2-digit", minute: "2-digit" }
  var options = { weekday: 'long', month: 'long', day: 'numeric' }
  var todayTotal = parseInt(getCookie('todayTotal')) || 0
  var shistory = getCookie('shistory') ? JSON.parse(getCookie('shistory')) : []
  var td = new Date().toLocaleDateString('ko-KR', options)
  console.log(shistory)
  document.getElementById('title').innerHTML = new Date().toLocaleDateString('ko-KR', options) + ' ' + todayTotal + 'ml'
  function add(a) {
    if (td != new Date().toLocaleDateString('ko-KR', options)) {
      todayTotal = 0
      td = new Date().toLocaleDateString('ko-KR', options)
    }
    todayTotal += a
    console.log(new Date().toLocaleDateString('ko-KR', hoptions))
    shistory.push({
      time: new Date().toLocaleDateString('ko-KR', hoptions).split(' ').slice(3).join(' '),
      ml: a
    })
    shistory.reverse()
    setCookie('todayTotal', todayTotal)
    document.getElementById('title').innerText = new Date().toLocaleDateString('ko-KR', options) + ' ' + todayTotal + 'ml'
    document.getElementById('hist').innerHTML = ''
    setCookie('shistory', JSON.stringify(shistory))
    shistory.forEach((s, i) => {
      document.getElementById('hist').innerHTML += `<div class="alert alert-${i % 2 === 0 ? 'warning' : 'info'}" role="alert">
      <a href="#" class="alert-link">${s.time}</a> ${s.ml}ml
    </div>`
    })
  }
  window.onload = function () {
    shistory.forEach((s, i) => {
      document.getElementById('hist').innerHTML += `<div class="alert alert-${i % 2 === 0 ? 'warning' : 'info'}" role="alert">
      <a href="#" class="alert-link">${s.time}</a>${s.ml}
    </div>`
    })
  }
</script>

</html>
